{
  "Id": "ab6e9a4c-68f1-4921-8edc-576c461c65b1",
  "Name": "Leveling Script",
  "Description": "A leveling script used via the 'level' alias to level your characters.  This script works decently well but some of the issues are still be worked out.",
  "Author": "Rhien",
  "GameAddress": "dsl-mud.org",
  "Category": "Leveling",
  "Version": 1,
  "AliasList": [
    {
      "AliasExpression": "exp",
      "Command": "-----------------------------------------------\r\n-- Experience Tracker / Reporter\r\n-- Rhien, 2/20/2020\r\n-----------------------------------------------\r\n\r\nif \"%1\" == \"clear\" then\r\n\tglobal.mobs_killed_run = 0\r\n\tglobal.exp_run = 0\r\n\tlua:Echo(\"Experience leveling stats cleared.\")\r\nelseif \"%1\" == \"report\" then\r\n\tif global.exp_run ~= nill and global.mobs_killed_run ~= nill then\r\n\t\tlua:Send(\"gt I've gained \" .. lua:FormatNumber(global.exp_run) .. \" experience and killed \" .. global.mobs_killed_run .. \" mobs this run.\")\t\r\n\tend\r\n\r\n\tif global.merit_exp ~= nil then\r\n\t\tif global.merit_exp > 0 then\r\n\t\t\tlua:Send(\"gt I've gained \" .. lua:FormatNumber(global.merit_exp) .. \" merit experience total this run.\")\r\n\t\tend\r\n\tend\t\r\n\t\r\n\tlocal level = lua:GetVariable(\"Level\")\r\n\r\n\tif tonumber(level) >= 51 then\r\n\t\tlua:Send(\"gt Leveling Report: I have 0 experience till my next level.\")\t\t\r\n\telse\r\n\t\tlua:Send(\"gt Leveling Report: I have \" .. lua:FormatNumber(lua:GetVariable(\"ExpTnl\")) .. \" experience till my next level.\")\t\t\r\n\tend\t\r\nelse\r\n\tlua:Echo(\"Syntax: exp <clear|report>\")\r\nend",
      "Enabled": true,
      "Character": "",
      "Group": "",
      "IsLua": true,
      "Lock": false,
      "Count": 0,
      "PackageId": ""
    },
    {
      "AliasExpression": "level",
      "Command": "-- Automated Leveling Script\r\n-- Note, escape sequences need to be double escaped in the triggers.\r\n-- escape method, sanc command\r\n\r\n-- Parameters to change behavior.\r\nlocal attack_command = \"kill\"\r\nlocal post_attack_command = \"\"\r\nlocal end_command = \"recall;home;drink;food;land;sleep\"\r\nlocal haste_command = \"c haste\"\r\nlocal sanctuary_command = \"c sanc\"\r\nlocal pause_milliseconds = 2000\r\nlocal test_path = false\r\nlocal hp_threshold = 200\r\nlocal attempt_go_command = true\r\n\r\n-- * Area name is the friendly area name\r\n-- * Levels are the recommended levels\r\n-- * Start room is the room you must be in to start the leveling script doing the actual leveling.\r\n-- * Go command is the direction command that will walk you to the start room if you're not there.\r\n-- * Go pause is the number of seconds that the script should wait to allow for walking to the leveling area.\r\n-- * Path is the actual path to walk, including opening doors, entering portals, etc.\r\n-- * Trigger is the list of triggers seperated by | that make you attack things.  (?<MobTarget[\\\\w'-+) should be put\r\n--   to replace a word in the description of the mob (that is also a keyword, it will use this to attack the mob).\r\nareas = {\r\n  [\"a-forest\"] = {\r\n    [\"area_name\"] = \"Ancient Forest\",\r\n    [\"levels\"] = \"43-51\",\r\n    [\"start_room\"] = \"A small trail leading deeper into the forest\",\r\n    [\"go_command\"] = \"#go Ancient Forest\",\r\n    [\"go_pause\"] = 35,\r\n    [\"path\"] = { \"w\", \"n\", \"w\", \"w\", \"w\", \"nw\", \"e\", \"e\", \"e\", \"n\", \"e\", \"w\", \"w\", \"w\", \"w\", \"ne\", \"e\", \"e\", \"e\", \"n\", \"w\", \"w\", \"w\", \"nw\", \"ne\", \"ne\", \"s\", \"s\", \"e\", \"e\", \"e\", \"e\", \"e\", \"n\", \"e\", \"n\", \"e\", \"s\", \"e\", \"s\", \"e\", \"w\", \"w\", \"w\", \"w\", \"w\", \"s\", \"e\", \"e\", \"e\", \"e\", \"s\", \"n\", \"w\", \"w\", \"w\", \"w\", \"e\", \"se\" },\r\n    [\"trigger\"] = \"A large furred creature trie(?<MobTarget>s) to hide in the forest.\"\r\n  },    \r\n  [\"asylum\"] = {\r\n    [\"area_name\"] = \"The Asylum\",\r\n    [\"levels\"] = \"25-35\",\r\n    [\"start_room\"] = \"The bottom of the hill\",\r\n    [\"go_command\"] = \"#go The Asylum\",\r\n    [\"go_pause\"] = 20,\r\n    [\"path\"] = { \"u\", \"u\", \"open north\", \"n\", \"w\", \"open north\", \"n\", \"s\", \"w\", \"open north\", \"n\", \"s\", \"w\", \"open north\", \"n\", \"s\", \"w\", \"open north\", \"n\", \"s\", \"w\", \"open north\", \"n\", \"s\", \"e\", \"e\", \"e\", \"e\", \"e\", \"open north\", \"n\", \"s\", \"e\", \"open north\", \"n\", \"s\", \"e\", \"open north\", \"n\", \"s\", \"e\", \"open north\", \"n\", \"s\", \"e\", \"open north\", \"n\", \"s\", \"e\", \"open north\", \"n\", \"s\", \"w\", \"w\", \"w\", \"w\", \"w\", \"n\", \"u\", \"u\", \"open north\", \"n\", \"n\", \"n\", \"e\", \"open east;open north;open south\", \"n\", \"s\", \"e\", \"w\", \"s\", \"n\", \"w\", \"n\", \"e\", \"open east;open north;open south\", \"n\", \"s\", \"e\", \"w\", \"s\", \"n\", \"w\", \"w\", \"open west;open north;open south\", \"n\", \"s\", \"w\", \"e\", \"s\", \"n\", \"e\", \"s\", \"s\", \"s\", \"s\", \"d\", \"open west\", \"w\", \"n\", \"n\", \"n\", \"open n\", \"n\", \"s\", \"s\", \"s\", \"s\", \"e\", \"d\", \"d\", \"open south\", \"s\", \"nw\", \"se\", \"sw\" },\r\n    [\"trigger\"] = \"A (?<MobTarget>[\\\\w'-]+) Shalonesti elf is shackled to the floor.|A (?<MobTarget>[\\\\w'-]+) Shalonesti elf is curled up in the corner.|A heavily robed (?<MobTarget>[\\\\w'-]+) roams the halls.|A distinguished looking elven (?<MobTarget>[\\\\w'-]+) stands here.|A raving half (?<MobTarget>[\\\\w'-]+) is sitting cross legged in the center of the room.|An insane Sea-(?<MobTarget>[\\\\w'-]+) is dangling from the ceiling, bound in shackles.|A (?<MobTarget>[\\\\w'-]+) elvish man wanders around cleaning up.\"\r\n  },\r\n  [\"crystal-bay\"] = {\r\n    [\"area_name\"] = \"Crystal Bay\",\r\n    [\"levels\"] = \"40-51\",\r\n    [\"start_room\"] = \"A sandy pass\",\r\n    [\"go_command\"] = \"#go Crystal Bay\",\r\n    [\"go_pause\"] = 10,\r\n    [\"path\"] = { \"s\",\"se\",\"se\",\"se\",\"se\",\"sw\",\"sw\",\"sw\",\"sw\",\"nw\",\"nw\",\"nw\",\"nw\",\"ne\",\"ne\",\"nw\",\"se\",\"sw\",\"sw\",\"se\",\"se\",\"se\",\"sw\",\"s\" },\r\n    [\"trigger\"] = \"A large red (?<MobTarget>[\\\\w'-]+) sits here.|A large (?<MobTarget>[\\\\w'-]+) stands here fishing.|A small (?<MobTarget>[\\\\w'-]+) is laying here in the sand.|A sea-worn (?<MobTarget>[\\\\w'-]+) rests here.|A charmed (?<MobTarget>[\\\\w'-]+) stands here gazing into nothingness.\"\r\n  },    \r\n  [\"gahboom\"] = {\r\n    [\"area_name\"] = \"Gahboom Hill\",\r\n    [\"levels\"] = \"43-51\",\r\n    [\"start_room\"] = \"A Stone Slab Platform in Fling-fall Cavern\",\r\n    [\"go_command\"] = \"#go Gahboom (Lower Flinger)\",\r\n    [\"go_pause\"] = 30,\r\n    [\"path\"] = { \"open north;n\", \"n\", \"se\", \"se\", \"e\", \"nw\", \"nw\", \"e\", \"e\", \"s\", \"s\", \"e\", \"w\", \"n\", \"n\", \"w\", \"w\", \"se\", \"se\", \"w\", \"nw\", \"nw\", \"s\", \"s\", \"pull flinger;d;open e; e\", \"e\", \"n\", \"e\", \"e\", \"e\", \"s\", \"w\", \"w\", \"w\", \"w\", \"w\", \"d\" },\r\n    [\"trigger\"] = \"A gnome stone (?<MobTarget>[\\\\w'-]+) is here.|A gnome in a protective (?<MobTarget>[\\\\w'-]+) suit is studying here.|A gnome gem (?<MobTarget>[\\\\w'-]+) is here.|A tinker gnome (?<MobTarget>[\\\\w'-]+) is picking up trash here.|A gnome (?<MobTarget>[\\\\w'-]+) is here.|A gnome philosophy (?<MobTarget>[\\\\w'-]+) is here.\"\r\n  },\r\n  [\"jixpk\"] = {\r\n    [\"area_name\"] = \"Jixpk Village\",\r\n    [\"levels\"] = \"30-35\",\r\n    [\"start_room\"] = \"Path to Gated Entrance\",\r\n    [\"go_command\"] = \"#go Jinxp Village\",\r\n    [\"go_pause\"] = 20,\r\n    [\"path\"] = { \"east\", \"open north;north\", \"south\", \"east\", \"open north;north\", \"south\", \"east\", \"south\", \"open east;east\", \"west\", \"south\", \"open east;east\", \"west\", \"south\", \"west\", \"open south;south\", \"north\", \"west\", \"open south;south\", \"north\", \"west\", \"north\", \"open west;west\", \"east\", \"north\", \"open west;west\", \"east\", \"north\", \"east\", \"south\", \"west\", \"east\", \"south\", \"south\", \"north\", \"east\", \"east\", \"west\", \"north\", \"north\", \"south\", \"west\", \"north\", \"west\", \"open west;west\", \"west\", \"west\" },\r\n    [\"trigger\"] = \"A small minotaur (?<MobTarget>[\\\\w'-]+) with rusty fur plays with some sticks.|A young minotaur (?<MobTarget>[\\\\w'-]+) plays with a wooden sword.|A minotaur (?<MobTarget>[\\\\w'-]+) runs about doing chores.|A minotaur (?<MobTarget>[\\\\w'-]+) surveys the area.|A rather young minotaur (?<MobTarget>[\\\\w'-]+) runs some errands.|A strong (?<MobTarget>[\\\\w'-]+) tends to his duties.|A female (?<MobTarget>[\\\\w'-]+) works at her daily tasks.|An aged (?<MobTarget>[\\\\w'-]+) stands here lecturing about being a minotuar.\"\r\n  },\r\n  [\"groves\"] = {\r\n    [\"area_name\"] = \"The Groves\",\r\n    [\"levels\"] = \"30-40\",\r\n    [\"start_room\"] = \"A Weatherworn Archway\",\r\n    [\"go_command\"] = \"#go The Groves\",\r\n    [\"go_pause\"] = 20,\r\n    [\"path\"] = { \"n\", \"nw\", \"e\", \"e\", \"ne\", \"w\", \"w\", \"sw\", \"n\", \"e\", \"n\", \"e\", \"e\", \"e\", \"w\", \"w\", \"w\", \"w\", \"w\", \"w\", \"ne\", \"e\", \"e\", \"e\", \"e\", \"nw\", \"w\", \"w\", \"ne\", \"s\", \"s\", \"s\", \"enter well\", \"n\", \"n\", \"n\", \"n\", \"e\", \"e\", \"e\", \"e\", \"n\", \"w\", \"w\", \"w\", \"w\", \"n\", \"e\", \"e\", \"e\", \"e\", \"n\", \"w\", \"w\", \"w\", \"w\", \"e\", \"e\", \"open north\", \"n\", \"n\", \"n\", \"n\", \"n\", \"u\", \"u\", \"u\", \"n\", \"w\", \"e\", \"e\", \"ne\", \"w\", \"w\", \"w\", \"w\", \"ne\", \"e\", \"e\", \"nw\" },\r\n    [\"trigger\"] = \"A forest (?<MobTarget>[\\\\w'-]+) silently wandering the grove is here.|A huge, gnarled (?<MobTarget>[\\\\w'-]+) stands here.|A large (?<MobTarget>[\\\\w'-]+) stands here deciding which tree to down next.|A black (?<MobTarget>[\\\\w'-]+) is flying aggressively here.|(Translucent) A translucent (?<MobTarget>[\\\\w'-]+) apparition floats here.|A dwarven (?<MobTarget>[\\\\w'-]+) walks about the area.|A ancient and gnarled (?<MobTarget>[\\\\w'-]+) stands here.\"\r\n  },    \r\n  [\"greattree\"] = {\r\n    [\"area_name\"] = \"Within the Great Tree\",\r\n    [\"levels\"] = \"22-33\",\r\n    [\"start_room\"] = \"Climbing the Great Tree\",\r\n    [\"go_command\"] = \"#go Within the Great Tree\",\r\n    [\"go_pause\"] = 10,\r\n    [\"path\"] = { \"u\", \"nw\", \"ne\", \"se\", \"u\", \"sw\", \"nw\", \"ne\", \"u\", \"sw\", \"w\", \"nw\", \"se\", \"sw\", \"ne\", \"e\", \"se\", \"ne\", \"e\", \"ne\", \"sw\", \"se\", \"nw\", \"w\", \"nw\", \"d\", \"se\", \"d\", \"sw\", \"d\", \"d\" },\r\n    [\"trigger\"] = \"An enlarged (?<MobTarget>[\\\\w'-]+) scurries about here.|An oversized (?<MobTarget>[\\\\w'-]+) crouches here.|An enormous (?<MobTarget>[\\\\w'-]+) flits about the branches.|An extremely large (?<MobTarget>[\\\\w'-]+) perches here.\"\r\n  }\r\n}\r\n\r\n-- Cancel out the leveling script.\r\nif \"%1\" == \"cancel\" or \"%1\" == \"clear\" or \"%1\" == \"stop\" or \"%1\" == \"end\" then\r\n    global.step_position = 0\r\n    global.is_fighting = false\r\n    global.leveling_script = false\r\n    lua:SetVariable(\"MobTarget\", \"\")\r\n    lua:DisableGroup(\"LevelingScript\")\r\n    lua:DisableGroup(\"LevelingTest\")\r\n    lua:Echo(\"Leveling script cancelled.\")\r\n    do return end\r\nelseif \"%1\" == \"stats\" then\r\n    -- Initialize variabless\r\n    if global.exp_run == nil then\r\n        global.exp_run = 0\r\n        global.mobs_killed_run = 0\r\n        global.merit_exp = 0\r\n        lua:Echo(\"{c={C>{x You have no experience statistics for this run.\")\r\n        do return end\r\n    end\r\n\r\n    if global.exp_run == 0 then\r\n        lua:Echo(\"{c={C>{x You have no experience statistics for this run.\")\r\n        do return end\r\n    end\r\n\r\n    -- Echo to yourself the details\r\n    local level = lua:GetVariable(\"Level\")\r\n    \r\n    if tonumber(level) >= 51 then\r\n        lua:Echo(\"{c={C>{x You have {y0{x experience till your next level.\")\r\n    else\r\n        lua:Echo(\"{c={C>{x You have {y\" .. lua:FormatNumber(lua:GetVariable(\"ExpTnl\")) .. \"{x experience till your next level.\")\r\n    end\r\n    \r\n    if global.mobs_killed_run > 0 then\r\n        avg = global.exp_run / global.mobs_killed_run\r\n    else\r\n        avg = 0\r\n    end\r\n    \r\n    lua:Echo(\"{c={C>{x You've gained {y\" .. lua:FormatNumber(global.exp_run) .. \"{x experience and killed {y\" .. global.mobs_killed_run .. \"{x mobs this run (\" .. lua:FormatNumber(global.exp_run / global.mobs_killed_run) .. \" exp per kill).\")\r\n    \r\n    if global.merit_exp > 0 then\r\n        lua:Echo(\"{c={C>{x You have gained {y\" .. lua:FormatNumber(global.merit_exp) .. \"{x merit experience total this run.\")\r\n    end\r\n    \r\n    do return end\r\nend\r\n\r\n-- If we're only going to walk the path as a test to see if it's valid.  Lower\r\n-- the wait if this mode is used so it walks quicker.\r\nif \"%1\" == \"test\" then\r\n    test_path = true\r\n    pause_milliseconds = 750\r\nend\r\n\r\n-- Syntax: level start <area name>\")\r\nif \"%1\" == \"\" or areas[\"%2\"] == nil then\r\n    local buf = \"\\r\\n\"\r\n    buf = buf .. \"{x|-|---------------------------------------------------------------------|-|{x\\r\\n\"\r\n    buf = buf .. \"{x| |                          ~= Leveling =~                             | |{x\\r\\n\"\r\n    buf = buf .. \"{x|-|---------------------------------------------------------------------|-|{x\\r\\n\"\r\n    buf = buf .. \"{x| |   Start Walking for an Area{W:{x {Ylevel start <area name>{x                | |{x\\r\\n\"\r\n    buf = buf .. \"{x| | Test Walking (no attacking){W:{x {Ylevel test <area name>{x                 | |{x\\r\\n\"\r\n    buf = buf .. \"{x| |              Cancels script{W:{x {Ylevel cancel{x                           | |{x\\r\\n\"\r\n    buf = buf .. \"{x| |            Shows statistics{W:{x {Ylevel stats{x                            | |{x\\r\\n\"\r\n    buf = buf .. \"{x|-|---------------------------------------------------------------------|-|{x\\r\\n\"\r\n    buf = buf .. \"{x| |                           ~= Areas =~                               | |{x\\r\\n\"\r\n    buf = buf .. \"{x|-|---------------------------------------------------------------------|-|{x\\r\\n\"\r\n    buf = buf .. \"{x| | \" .. string.format(\"%-16s\", \"{_Area{x\") .. string.format(\"%-12s\", \"{_Levels{x\") .. string.format(\"%-44s\", \"{_Starting Room{x\") .. \"        | |{x\\r\\n\"\r\n    \r\n    for k,v in pairs(areas) do \r\n        buf = buf .. \"{x| | \" .. string.format(\"%-12s\", k) .. string.format(\"%-8s\", v[\"levels\"]) .. string.format(\"%-47s\", v[\"start_room\"]) .. \" | |\\r\\n\"\r\n        buf = buf .. \"{x| | \" .. string.format(\"%-20s\", \"\") .. \"{Y\" .. string.format(\"%-40s\", v[\"go_command\"]) .. \"{x        | |\\r\\n\"\r\n    end\r\n\r\n    buf = buf .. \"{x|-|---------------------------------------------------------------------|-|{x\\r\\n\\r\\n\"\r\n\r\n    lua:Echo(buf)\r\n    do return end\r\nend\r\n\r\n-- Do we start?\r\nif \"%1\" == \"start\" or \"%1\" == \"test\" then\r\n    local room = lua:GetVariable(\"Room\")\r\n\r\n    -- If it's a test, enable the test trigger that stops the script on going a direction it can't walk.\r\n    -- That trigger will echo the position in the directions array as well as the direction.  Handy\r\n    -- debugging info for getting the path right.  When the path does a \"level cancel\" this will disable.\r\n    if \"%1\" == \"test\" then\r\n        lua:Send(\"#trigger -i \\\"a90fd64d-3980-45e9-9f09-8dc0a7e9118d'\\\" -e\")\r\n    end\r\n\r\n    -- Attempt the go command if that setting is set.  We'll need to pause after\r\n    -- it to allow for walking time.\r\n    if room ~= areas[\"%2\"][\"start_room\"] and attempt_go_command == true then\r\n        lua:Send(areas[\"%2\"][\"go_command\"])\r\n        \r\n        -- Sleep for 20 seconds to allow for walking.\r\n        lua.Echo(\"Sleeping for \" .. areas[\"%2\"][\"go_pause\"] .. \" seconds to allow for walking.\")\r\n        lua.Sleep(1000 * areas[\"%2\"][\"go_pause\"])\r\n        \r\n        -- Update the room variable with its new version.\r\n        room = lua:GetVariable(\"Room\")\r\n    end\r\n\r\n    if room ~= areas[\"%2\"][\"start_room\"] then\r\n        lua:Echo(\"In order to start the path for '%2' you need to be in the room '\" .. areas[\"%2\"][\"start_room\"] .. \"' and you are in the room '\" .. room .. \"'\")\r\n        do return end\r\n    end\r\n    \r\n    lua:Echo(\"Starting %2: You will return home at \" .. hp_threshold .. \"hp if it comes to that.\")\r\n    lua:SetVariable(\"MobTarget\", \"\")\r\n    global.step_position = 0\r\n    global.is_fighting = false    \r\n    global.leveling_script = false -- Initially set to false so it has a value, will be set when it gets farther down to true\r\nend\r\n\r\n-- If the leveling script is already active don't re-enter.\r\nif global.leveling_script == true then\r\n    lua:Echo(\"Leveling script already active.  Cancel with 'level cancel' if you wish to abort it.\")\r\n    do return end\r\nend\r\n\r\n-- Update the trigger that we're going to use to hit the mobs.\r\nlocal trigger = \"#trigger -i \\\"9fb7ac13-4182-4935-ba67-d787977457cc\\\" -p \\\"\" .. areas[\"%2\"][\"trigger\"] .. \"\\\" -g \\\"LevelingScript\\\" \"\r\n--lua:Echo(trigger)\r\nlua:Send(trigger)\r\n\r\n-- The direction path, we'll swap in the correct path based off of the area.\r\nlocal dir_list = areas[\"%2\"][\"path\"]\r\n\r\n-- Set the leveling script to active and enable the triggers for it\r\nglobal.leveling_script = true\r\nlua:EnableGroup(\"LevelingScript\")\r\n\r\nwhile(global.leveling_script)\r\ndo\r\n    local hp = lua.GetVariable(\"Health\")\r\n\r\n    -- Health check\r\n    if global.is_fighting == false and tonumber(hp) < hp_threshold then\r\n        lua:Echo(\"Leveling script has determined you're below the HP threshold level.  Your return home command will now be executed.\")\r\n        lua:Send(\"level cancel\")\r\n        \r\n        -- If an end command is defined, run it.\r\n        if end_command ~= \"\" then\r\n            lua:Send(end_command)\r\n        end            \r\n        \r\n        do return end\r\n    elseif global.is_fighting == true and tonumber(hp) < hp_threshold then\r\n        -- They're fighting, try to flee out, then on the next loop if they do this will either run again\r\n        -- or they'll return.\r\n        lua:Send(\"flee;flee;flee;flee;flee;flee;flee\")\r\n    end\r\n    \r\n    -- If we're not fighting, but we have a target, kill it.\r\n    if global.is_fighting == false and lua:GetVariable(\"MobTarget\") ~= \"\" and test_path == false then\r\n        -- Send the sanctuary command before we attack and then also pause for a second\r\n        -- so the lag from it can pass.\r\n        if dsl:IsAffected(\"sanctuary\") == false and sanctuary_command ~= \"\" then\r\n            lua.Echo(\"Executing sanctuary command.\")\r\n            lua.Send(santuary_command)\r\n            lua:Sleep(2000)        \r\n        end\r\n\r\n        -- Send the attack command which is declare in the variables.\r\n        lua:Send(attack_command .. \" \" .. lua:GetVariable(\"MobTarget\"))\r\n\r\n        -- Send any commands that should be run after attack (casting faerie fire, etc.)\r\n        if post_attack_command ~= \"\" then\r\n            lua:Send(post_attack_command)\r\n        end\r\n                \r\n        global.is_fighting = true\r\n        \r\n        -- If we're not affected by haste and there is a haste command execute it (quaff or cast)\r\n        if dsl:IsAffected(\"haste\") == false and haste_command ~= \"\" then\r\n            lua:Send(haste_command)\r\n            lua:Send(\"aff\")\r\n        end\r\n                \r\n    end\r\n    \r\n    -- If the player isn't in combat from the leveling script then step to the next position, then pause\r\n    -- and see if there's anything to combat.\r\n    if global.is_fighting == false then\r\n        global.step_position = global.step_position + 1\r\n    \r\n        if dir_list[global.step_position] == nil then\r\n            lua:Echo(\"Leveling script has reached the end of the path.\")\r\n            lua:Send(\"level cancel\")\r\n            \r\n            -- If an end command is defined, run it.\r\n            if end_command ~= \"\" then\r\n                lua:Send(end_command)\r\n            end            \r\n            \r\n            do return end\r\n        end\r\n    \r\n        -- loop, is fighting check, global for cancel, global to prevent two of thess from running at the same time\r\n        lua:Send(dir_list[global.step_position])\r\n        \r\n        -- Save the last step made for debugging purposes\r\n        global.last_step = dir_list[global.step_position]\r\n    end\r\n\r\n    -- 2 second pause each loop by default or whatever the user sets in this variable, this will keep the CPU usage very \r\n    -- low and allow for other variables to process that effect each loop\r\n    lua:Sleep(pause_milliseconds)\r\nend\r\n\r\nlua:Echo(\"End of leveling script, if you got here there was either a cancel or a problem with the script.\")",
      "Enabled": true,
      "Character": "",
      "Group": "",
      "IsLua": true,
      "Lock": true,
      "Count": 0,
      "PackageId": ""
    }
  ],
  "TriggerList": [
    {
      "Command": "-- Set the fighting variable to true.\r\nlua.Echo(\"You are still fighting, setting the is_fighting variable to true.\")\r\nglobal.is_fighting = true",
      "Pattern": "fighting YOU\\!",
      "Character": "",
      "Group": "LevelingScript",
      "IsSilent": false,
      "IsLua": true,
      "Plugin": false,
      "DisableAfterTriggered": false,
      "Lock": false,
      "LastMatched": "0001-01-01T00:00:00",
      "VariableReplacement": false,
      "Enabled": false,
      "Gag": false,
      "MoveTo": 0,
      "HighlightLine": false,
      "Count": 0,
      "Priority": 10000,
      "StopProcessing": false,
      "Identifier": "3f88c6a5-5f6f-4bea-a09d-8e1791f552dc",
      "PackageId": "",
      "SystemTrigger": false
    },
    {
      "Command": "sac cor",
      "Pattern": "The corpse of",
      "Character": "",
      "Group": "LevelingScript",
      "IsSilent": false,
      "IsLua": false,
      "Plugin": false,
      "DisableAfterTriggered": false,
      "Lock": false,
      "LastMatched": "0001-01-01T00:00:00",
      "VariableReplacement": false,
      "Enabled": false,
      "Gag": false,
      "MoveTo": 0,
      "HighlightLine": false,
      "Count": 0,
      "Priority": 10000,
      "StopProcessing": false,
      "Identifier": "33cbed9f-5eea-4805-aaf2-bae504128a2e",
      "PackageId": "",
      "SystemTrigger": false
    },
    {
      "Command": "sac entrail",
      "Pattern": "A (steaming pile) of (.*) entrails is lying here.",
      "Character": "",
      "Group": "LevelingScript",
      "IsSilent": false,
      "IsLua": false,
      "Plugin": false,
      "DisableAfterTriggered": false,
      "Lock": false,
      "LastMatched": "0001-01-01T00:00:00",
      "VariableReplacement": false,
      "Enabled": false,
      "Gag": false,
      "MoveTo": 0,
      "HighlightLine": false,
      "Count": 0,
      "Priority": 10000,
      "StopProcessing": false,
      "Identifier": "62ebea1c-9c1e-41b3-88b7-d49a8d158ba5",
      "PackageId": "",
      "SystemTrigger": false
    },
    {
      "Command": "#echo -t Terminal1 -c Cyan -r %0",
      "Pattern": "You raise a level!!  You gain (\\d+) hit points, (\\d+) mana, (\\d+) move, and (\\d+) practices.",
      "Character": "",
      "Group": "LevelingScript",
      "IsSilent": false,
      "IsLua": false,
      "Plugin": false,
      "DisableAfterTriggered": false,
      "Lock": false,
      "LastMatched": "0001-01-01T00:00:00",
      "VariableReplacement": false,
      "Enabled": false,
      "Gag": false,
      "MoveTo": 0,
      "HighlightLine": false,
      "Count": 0,
      "Priority": 10000,
      "StopProcessing": false,
      "Identifier": "aaf4e15e-3ae2-48f0-b836-417bb812f54d",
      "PackageId": "",
      "SystemTrigger": false
    },
    {
      "Command": "sac guts",
      "Pattern": " is DEAD!!",
      "Character": "",
      "Group": "LevelingScript",
      "IsSilent": false,
      "IsLua": false,
      "Plugin": false,
      "DisableAfterTriggered": false,
      "Lock": false,
      "LastMatched": "0001-01-01T00:00:00",
      "VariableReplacement": false,
      "Enabled": false,
      "Gag": false,
      "MoveTo": 0,
      "HighlightLine": false,
      "Count": 0,
      "Priority": 10000,
      "StopProcessing": false,
      "Identifier": "d5528992-b65d-4dae-87aa-8af899928111",
      "PackageId": "",
      "SystemTrigger": false
    },
    {
      "Command": "-----------------------------------------------\r\n-- Experience Tracker / Reporter\r\n-- Rhien, 2/20/2020\r\n-----------------------------------------------\r\n\r\n-- Options\r\ntell_group = false -- Report to the group what the current stats are.\r\n\r\n-- Initialize variabless\r\nif global.exp_run == nil then\r\n\tglobal.exp_run = 0\r\nend\r\n\r\nif global.mobs_killed_run == nil then\r\n\tglobal.mobs_killed_run = 0\r\nend\r\n\r\n-- This is set from another trigger.\r\nif global.merit_exp == nil then\r\n\tglobal.merit_exp = 0\r\nend\r\n\r\n-- %1 is going to be a number, turn the variable we've stored into a number\r\n-- for tracking experience for this round and add them together\r\nglobal.exp_run = global.exp_run + %1\r\nglobal.mobs_killed_run = global.mobs_killed_run + 1\r\n\r\n-- Echo to yourself the details\r\nlocal level = lua:GetVariable(\"Level\")\r\n\r\nif tonumber(level) >= 51 then\r\n\tlua:Echo(\"You have 0 experience till your next level.\")\r\nelse\r\n\tlua:Echo(\"You have \" .. lua:FormatNumber(lua:GetVariable(\"ExpTnl\")) .. \" experience till your next level.\")\r\nend\r\n\r\nif global.mobs_killed_run > 0 then\r\n\tavg = global.exp_run / global.mobs_killed_run\r\nelse\r\n\tavg = 0\r\nend\r\n\r\nlua:Echo(\"You've gained \" .. lua:FormatNumber(global.exp_run) .. \" experience and killed \" .. global.mobs_killed_run .. \" mobs this run (\" .. lua:FormatNumber(global.exp_run / global.mobs_killed_run) .. \" exp per kill).\")\r\n\r\nif global.merit_exp > 0 then\r\n\tlua:Echo(\"You have gained \" .. lua:FormatNumber(global.merit_exp) .. \" merit experience total this run.\")\r\nend\r\n\r\n-- Use group tell what the stats are.\r\nif tell_group == true then\r\n\tlua:Send(\"gt Leveling Report: I have \" .. lua:FormatNumber(lua:GetVariable(\"ExpTnl\")) .. \" experience till my next level.\")\r\nend",
      "Pattern": "You receive (\\w+) experience points.",
      "Character": "",
      "Group": "LevelingScript",
      "IsSilent": false,
      "IsLua": true,
      "Plugin": false,
      "DisableAfterTriggered": false,
      "Lock": false,
      "LastMatched": "0001-01-01T00:00:00",
      "VariableReplacement": false,
      "Enabled": false,
      "Gag": false,
      "MoveTo": 0,
      "HighlightLine": false,
      "Count": 0,
      "Priority": 10000,
      "StopProcessing": false,
      "Identifier": "4a18f3fb-42fc-4e51-9f73-5809d232ec23",
      "PackageId": "",
      "SystemTrigger": false
    },
    {
      "Command": "-- Clear the mob targets that we had.\r\nlua:SetVariable(\"MobTarget\", \"\")\r\n\r\n-- Set the fighting to false\r\nglobal.is_fighting = false\r\n\r\n-- Look in the room so that any triggers can gather a new target.\r\nlua:Send(\"look\")",
      "Pattern": "^You receive (\\w+) experience points.|^Join a clan if you want to kill players|^You don't own that monster|^They aren't here|(\\w+) has fled",
      "Character": "",
      "Group": "LevelingScript",
      "IsSilent": false,
      "IsLua": true,
      "Plugin": false,
      "DisableAfterTriggered": false,
      "Lock": false,
      "LastMatched": "0001-01-01T00:00:00",
      "VariableReplacement": false,
      "Enabled": false,
      "Gag": false,
      "MoveTo": 0,
      "HighlightLine": false,
      "Count": 0,
      "Priority": 10000,
      "StopProcessing": false,
      "Identifier": "f74ee53a-367b-4628-9fd0-6b9f961e3991",
      "PackageId": "",
      "SystemTrigger": false
    },
    {
      "Command": "-----------------------------------------------\r\n-- Experience Tracker / Reporter\r\n-- Rhien, 2/20/2020\r\n-----------------------------------------------\r\n\r\n-- Initialize variabless\r\nif global.merit_exp == nil then\r\n\tglobal.merit_exp = 0\r\nend\r\n\r\n-- %1 is going to be a number, turn the variable we've stored into a number\r\n-- for tracking experience for this round and add them together\r\nglobal.merit_exp = global.merit_exp + %1",
      "Pattern": "You receive (\\w+) merit experience points.",
      "Character": "",
      "Group": "LevelingScript",
      "IsSilent": false,
      "IsLua": true,
      "Plugin": false,
      "DisableAfterTriggered": false,
      "Lock": false,
      "LastMatched": "0001-01-01T00:00:00",
      "VariableReplacement": false,
      "Enabled": false,
      "Gag": false,
      "MoveTo": 0,
      "HighlightLine": false,
      "Count": 0,
      "Priority": 10000,
      "StopProcessing": false,
      "Identifier": "50946167-90f9-4d8c-859d-eac64c6bff2d",
      "PackageId": "",
      "SystemTrigger": false
    },
    {
      "Command": "-- Clear the mob targets that we had, do -not- look, we want the script to walk to the\r\n-- next room.\r\nlua:SetVariable(\"MobTarget\", \"\")\r\n\r\n-- Set the fighting to false\r\nglobal.is_fighting = false\r\n",
      "Pattern": "^Kill stealing is not permitted.",
      "Character": "",
      "Group": "LevelingScript",
      "IsSilent": false,
      "IsLua": true,
      "Plugin": false,
      "DisableAfterTriggered": false,
      "Lock": false,
      "LastMatched": "0001-01-01T00:00:00",
      "VariableReplacement": false,
      "Enabled": false,
      "Gag": false,
      "MoveTo": 0,
      "HighlightLine": false,
      "Count": 0,
      "Priority": 10000,
      "StopProcessing": false,
      "Identifier": "e4a7eef6-ae9c-4a51-9c5d-e8210daff116",
      "PackageId": "",
      "SystemTrigger": false
    },
    {
      "Command": "stand",
      "Pattern": "^Better stand up first.",
      "Character": "",
      "Group": "LevelingScript",
      "IsSilent": false,
      "IsLua": false,
      "Plugin": false,
      "DisableAfterTriggered": false,
      "Lock": false,
      "LastMatched": "0001-01-01T00:00:00",
      "VariableReplacement": false,
      "Enabled": false,
      "Gag": false,
      "MoveTo": 0,
      "HighlightLine": false,
      "Count": 0,
      "Priority": 10000,
      "StopProcessing": false,
      "Identifier": "84f95313-94a2-4771-b69f-e8df2622a7c2",
      "PackageId": "",
      "SystemTrigger": false
    },
    {
      "Command": "",
      "Pattern": "A large red (?<MobTarget>[\\w'-]+) sits here.|A large (?<MobTarget>[\\w'-]+) stands here fishing.|A small (?<MobTarget>[\\w'-]+) is laying here in the sand.|A sea-worn (?<MobTarget>[\\w'-]+) rests here.|A charmed (?<MobTarget>[\\w'-]+) stands here gazing into nothingness.",
      "Character": "",
      "Group": "LevelingScript",
      "IsSilent": false,
      "IsLua": false,
      "Plugin": false,
      "DisableAfterTriggered": false,
      "Lock": false,
      "LastMatched": "0001-01-01T00:00:00",
      "VariableReplacement": false,
      "Enabled": false,
      "Gag": false,
      "MoveTo": 0,
      "HighlightLine": false,
      "Count": 0,
      "Priority": 10000,
      "StopProcessing": false,
      "Identifier": "9fb7ac13-4182-4935-ba67-d787977457cc",
      "PackageId": "",
      "SystemTrigger": false
    },
    {
      "Command": "-- Clear the mob targets that we had, do -not- look, we want the script to walk to the\r\n-- next room.\r\nlua.Echo(\"Mob missing, may have moved too fast.  Setting fighting and mob target to false.\")\r\nlua:SetVariable(\"MobTarget\", \"\")\r\n\r\n-- Set the fighting to false\r\nglobal.is_fighting = false\r\n",
      "Pattern": "They aren't here.",
      "Character": "",
      "Group": "LevelingScript",
      "IsSilent": false,
      "IsLua": true,
      "Plugin": false,
      "DisableAfterTriggered": false,
      "Lock": false,
      "LastMatched": "0001-01-01T00:00:00",
      "VariableReplacement": false,
      "Enabled": false,
      "Gag": false,
      "MoveTo": 0,
      "HighlightLine": false,
      "Count": 0,
      "Priority": 10000,
      "StopProcessing": false,
      "Identifier": "e7abf704-d515-4ac7-ba6f-f7413f33f375",
      "PackageId": "",
      "SystemTrigger": false
    },
    {
      "Command": "-- Set the fighting variable to false.\r\nlua.Echo(\"Fled from combating, settinng is fighting to false\")\r\nglobal.is_fighting = false",
      "Pattern": "(You flee from combat!|You spring off a wall, somersault high and escape the fray!|You duck low in the high grass and roll out of the fray!)",
      "Character": "",
      "Group": "LevelingScript",
      "IsSilent": false,
      "IsLua": true,
      "Plugin": false,
      "DisableAfterTriggered": false,
      "Lock": false,
      "LastMatched": "0001-01-01T00:00:00",
      "VariableReplacement": false,
      "Enabled": false,
      "Gag": false,
      "MoveTo": 0,
      "HighlightLine": false,
      "Count": 0,
      "Priority": 10000,
      "StopProcessing": false,
      "Identifier": "d32b91e6-5ff1-4954-a60d-44e457b839d8",
      "PackageId": "",
      "SystemTrigger": false
    },
    {
      "Command": "-- Echo the results\r\nlua:Echo(\"Bumped into a wall: step_position=\" .. global.step_position .. \" direction=\" .. global.last_step)\r\n\r\n-- Cancel the walking so we can fix.\r\nlua:Send(\"level cancel\")",
      "Pattern": "Alas, you cannot go that way.",
      "Character": "",
      "Group": "LevelingTest",
      "IsSilent": false,
      "IsLua": true,
      "Plugin": false,
      "DisableAfterTriggered": false,
      "Lock": false,
      "LastMatched": "0001-01-01T00:00:00",
      "VariableReplacement": false,
      "Enabled": false,
      "Gag": false,
      "MoveTo": 0,
      "HighlightLine": false,
      "Count": 0,
      "Priority": 10000,
      "StopProcessing": false,
      "Identifier": "a90fd64d-3980-45e9-9f09-8dc0a7e9118d",
      "PackageId": "",
      "SystemTrigger": false
    }
  ],
  "DirectionList": []
}